---
title: "STA 160 Midterm1"
author: "Eric Gao"
date: "4/11/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, echo = FALSE, message = FALSE, warning=FALSE}
setwd("~/STA160")
library(tidyverse)
library(readxl)
library(corrplot)
```

```{r}
airbnb =  read_csv("Airbnb_NYC_2019.csv", col_types = cols())
```

# What causes prices to be higher and can we make a model to predict the price?
# Do the number of reviews differ per borough?
# Does price vary with neighborhood?


First, let's clean the data

```{r}
airbnb = airbnb %>% na.omit()
#next remove all 0's from price
price_0 = which(airbnb$price >0, )
airbnb = airbnb[price_0, ]
#next, let's clean minimum_nights. 
```



First, we will plot the correlograms between the columns of numerical type

```{r}
updated_airbnb = airbnb %>% keep(is.numeric)
updated = updated_airbnb[,-c(1,2,3,4)] %>% na.omit()
pairs(updated)
```

Next, we will plot the respective correlation matrix between the numerical variables:

```{r}
corrplot(cor(updated), method = "number")
```
Both the correlation table and correlation matrix show that there is no significant collinearity so we can proceed.


Respective summary table for the numerical columns()

```{r}
summary(updated)
```

We will get rid of zero price, because a price of 0 is senseless:

```{r}
price_over0 = which(airbnb$price > 0)
airbnb = airbnb[price_over0, ]
```

First, we want to see if prices are greater for certain neighborhood groups:

```{r}
ggplot(airbnb, aes(price, fill = neighbourhood_group)) + geom_histogram()
```

# what kind of airbnb has prices over 1000?-could be interesting(what is similar-could be specific people)
```{r}
price_1000 = which(airbnb$price >= 1000)
airbnb_over_1000 = airbnb[price_1000, ]
ggplot(airbnb_over_1000, aes(price, fill = neighbourhood_group)) + geom_histogram()
```

From here, we can see the airbnb's that are the most expensive are the ones that are in Manhattan, which makes sense considering Manhattan is one of the richest boroughs in NYC. From here, can we see the different room types in Manhattan and compare the price?

```{r}
manhattan_1000 = which(airbnb_over_1000$neighbourhood_group == "Manhattan")
airbnb_man_1000 = airbnb_over_1000[manhattan_1000, ]
ggplot(airbnb_man_1000, aes(price, fill = room_type)) + geom_histogram()
```

From the plot above, we can see that for prices over $1000, we see that across all the prices, the ones that cost the most are entire homes/apts.

We will remove the name and host_name columns since they are represented by id and host_id:

```{r}
new_air = airbnb[, -c(2, 4)]
```   

Let's check if places with more reviews have higher prices per neighbor group. First, subset the number of reviews to be greater than 0

```{r}
reviews_over_zero = which(new_air$number_of_reviews > 0)
new_air1 = new_air[reviews_over_zero, ]
ggplot(new_air1, aes(price, number_of_reviews, color = as.factor(neighbourhood_group))) + geom_point()
```

There is no clear association between price and the number of reviews per neighborhood group.


Let's look at room type compared to price.

```{r}
ggplot(new_air, aes(minimum_nights, price, color = room_type)) + geom_point()
```

This scatter plot is too broad. We want to shrink the x axis. The average nights is only 7. Let's look at the range between 1 and 100.

```{r}

```

# Try Time Series

```{r}
plot()
```





